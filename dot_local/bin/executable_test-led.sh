#!/bin/bash

read -p "What's your sound card? Form /dev/snd/hwCxDx": card

echo "Testing GPIO pins, polarity 0"
for i in 0x01 0x02 0x04 0x08 0x10 0x20 0x40; do
  sudo hda-verb $card 0x01 0x716 $i
  sudo hda-verb $card 0x01 0x717 $i
  sudo hda-verb $card 0x01 0x715 $i
  sleep 1
done
echo "Testing GPIO pins, polarity 1"
for i in 0x01 0x02 0x04 0x08 0x10 0x20 0x40; do
  sudo hda-verb $card 0x01 0x716 $i
  sudo hda-verb $card 0x01 0x717 $i
  sudo hda-verb $card 0x01 0x715 0x00
  sleep 0.2
done
echo "Testing COEF and INDEX"
start=0x1
end=0xff
for ((i = $start; i <= $end; ++i)); do
  for j in 0x1 0x2 0x4 0x8 0x10 0x20 0x40 0x80 0x100 0x200 0x400 0x800 0x1000 0x2000 0x4000 0x8000; do
    sudo hda-verb $card 0x20 0x500 $i
    sudo hda-verb $card 0x20 0x400 $j
    sleep 0.2
  done
done
